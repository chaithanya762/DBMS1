

CREATE TABLE SALESMAN
  (
 SALESMAN_ID INT PRIMARY KEY,
 NAME VARCHAR(20),
 CITY VARCHAR(20),
 COMMISION CHAR(4));



CREATE TABLE CUSTOMER
 (
CUSTOMER_ID INT PRIMARY KEY,
CUST_NAME VARCHAR(20),
CITY VARCHAR(20),
GRADE INT,
SALESMAN_ID REFERENCES SALESMAN(SALESMAN_ID) ON DELETE SET NULL);


CREATE TABLE ORDERS
(
ORD_NO INT PRIMARY KEY,
PURCHASE_AMT REAL,
ORD_DATE DATE,
CUSTOMER_ID REFERENCES CUSTOMER(CUSTOMER_ID),
SALESMAN_ID REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE);



INSERT INTO SALESMAN VALUES (1000,'JOHN','BANGALORE','25 %');

INSERT INTO SALESMAN VALUES (2000,'RAVI','BANGALORE','20 %');

INSERT INTO SALESMAN VALUES (3000,'KUMAR','MYSORE','15 %');

INSERT INTO SALESMAN VALUES (4000,'SMITH','DELHI','30 %');

INSERT INTO SALESMAN VALUES (5000,'HARSHA','HYDRABAD','15 %');


INSERT INTO CUSTOMER VALUES (10,'PREETHI','BANGALORE', 100, 1000);

INSERT INTO CUSTOMER VALUES (11,'VIVEK','MANGALORE', 300, 1000);

INSERT INTO CUSTOMER VALUES (12,'BHASKAR','CHENNAI', 400, 2000);

INSERT INTO CUSTOMER VALUES (13,'CHETHAN','BANGALORE', 200, 2000);

INSERT INTO CUSTOMER VALUES (14,'MAMATHA','BANGALORE', 400, 3000);


INSERT INTO ORDERS VALUES (50, 5000,'04-MAY-17', 10, 1000);

INSERT INTO ORDERS VALUES (51, 450,'20-JAN-17', 10, 2000);

INSERT INTO ORDERS VALUES (52, 1000,'24-FEB-17', 13, 2000);

INSERT INTO ORDERS VALUES (53, 3500,'13-APR-17', 14, 3000);

INSERT INTO ORDERS VALUES (54, 550,'13-APR-17', 12, 3000);

queries:


 SELECT COUNT(CUSTOMER_ID) FROM CUSTOMER WHERE GRADE > (
 SELECT AVG(GRADE)
 FROM CUSTOMER
 WHERE CITY='BANGALORE');


 SELECT SALESMAN_ID,NAME FROM SALESMAN S
 WHERE
 (SELECT COUNT(*) FROM CUSTOMER WHERE SALESMAN_ID=S.SALESMAN_ID)>1;





 SELECT S.SALESMAN_ID,NAME,CUST_NAME FROM SALESMAN S, CUSTOMER C WHERE S.CITY=C.CITY AND S.SALESMAN_ID=C.SALESMAN_ID
 UNION
 SELECT  S.SALESMAN_ID,NAME,'NO MATCH' FROM SALESMAN S, CUSTOMER C WHERE NOT S.CITY=ANY(SELECT CITY FROM CUSTOMER);



 CREATE VIEW SALESMAN_ORDER AS
 SELECT B.ORD_DATE,A.SALESMAN_ID,
 NAME FROM SALESMAN A,ORDERS B
 WHERE A.SALESMAN_ID=B.SALESMAN_ID AND B.PURCHASE_AMT=(SELECT MAX(PURCHASE_AMT) FROM ORDERS C WHERE C.ORD_DATE=B.ORD_DATE);


 DELETE FROM SALESMAN WHERE SALESMAN_ID=1000;

